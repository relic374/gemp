#if 0
	shc Version 3.8.9, Generic Script Compiler
	Copyright (c) 1994-2012 Francisco Rosales <frosal@fi.upm.es>

	shc -T -f gemp.sh 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\355\066\205"
#define      text_z	2885
#define      text	((&data[105]))
	"\024\305\001\120\352\001\125\277\120\212\305\336\033\237\016\267"
	"\353\072\002\316\152\307\020\067\232\225\256\004\314\247\243\336"
	"\031\274\360\062\325\244\266\122\025\340\272\141\224\072\310\074"
	"\012\357\230\103\163\072\242\120\014\120\125\274\100\000\300\127"
	"\163\320\016\335\062\307\077\125\233\322\105\366\231\305\202\344"
	"\040\166\034\000\315\242\312\106\217\145\035\261\135\240\367\262"
	"\054\271\215\164\114\113\342\325\070\344\126\250\157\316\312\377"
	"\255\300\260\226\151\104\127\114\274\033\130\263\076\150\245\272"
	"\221\255\051\215\352\330\333\234\251\205\050\307\036\332\356\127"
	"\337\165\022\352\326\226\042\372\162\102\344\363\225\123\057\230"
	"\237\005\032\335\024\131\264\304\153\143\236\134\301\046\175\347"
	"\274\362\365\172\257\065\130\267\043\027\220\170\342\162\212\020"
	"\144\106\214\062\372\312\110\357\052\044\275\353\257\004\034\064"
	"\250\050\025\124\242\350\276\037\163\363\156\165\101\300\375\227"
	"\340\026\157\114\211\361\225\132\210\043\237\014\173\171\322\015"
	"\311\160\124\232\324\271\157\167\125\010\115\167\132\275\055\153"
	"\253\046\123\050\246\005\355\111\034\321\017\051\313\221\025\062"
	"\135\056\305\055\264\005\200\067\245\236\142\116\125\012\372\217"
	"\167\064\376\272\176\106\313\021\334\213\163\313\023\064\066\217"
	"\114\064\136\052\333\133\201\377\357\356\033\154\242\100\057\244"
	"\124\211\345\121\021\052\373\030\033\266\275\207\355\163\121\164"
	"\216\006\216\201\114\145\007\343\327\301\273\274\146\051\316\205"
	"\154\336\336\034\357\305\311\017\117\200\304\114\062\256\325\102"
	"\063\054\143\104\202\353\341\030\350\276\226\027\121\127\203\265"
	"\211\225\165\250\345\001\337\301\303\351\052\172\274\075\235\106"
	"\203\323\120\150\040\144\046\141\210\041\103\232\162\015\356\032"
	"\026\257\025\200\000\232\213\065\203\132\046\114\036\021\052\302"
	"\125\014\243\111\303\356\035\070\303\301\265\241\213\264\210\040"
	"\310\051\031\015\153\135\263\274\232\302\043\157\302\151\161\037"
	"\171\357\053\070\026\362\236\124\230\251\371\002\113\275\006\155"
	"\100\375\261\126\027\203\370\273\015\332\250\327\066\351\031\165"
	"\215\223\156\051\072\042\307\300\231\333\176\271\002\001\335\115"
	"\021\307\170\066\340\040\025\002\246\153\152\304\271\175\076\110"
	"\073\034\135\303\340\312\352\051\215\275\100\135\373\240\132\331"
	"\143\356\324\004\261\225\224\026\172\045\011\140\140\274\321\306"
	"\327\275\012\363\266\031\335\140\264\312\345\035\341\364\315\355"
	"\105\157\241\015\334\007\115\313\156\323\017\371\306\372\365\263"
	"\366\370\162\064\225\351\027\215\121\117\163\040\215\133\032\266"
	"\305\105\337\010\316\375\265\305\067\042\035\313\110\321\056\040"
	"\342\335\143\064\133\020\140\034\115\063\366\254\276\052\052\006"
	"\041\206\342\225\277\237\167\057\265\121\262\052\227\322\245\255"
	"\150\354\342\341\330\125\351\100\372\377\177\374\035\304\337\227"
	"\017\005\245\160\110\064\237\263\365\153\315\207\223\263\110\075"
	"\172\254\347\015\212\112\360\227\276\107\367\221\016\033\034\032"
	"\245\321\252\062\263\320\250\157\277\241\227\154\344\236\204\256"
	"\347\333\203\200\072\137\202\234\310\002\237\332\312\321\073\355"
	"\327\263\147\257\051\163\063\174\047\334\245\005\156\222\320\302"
	"\133\212\270\020\333\241\323\104\207\212\224\302\024\021\107\007"
	"\167\225\076\310\250\253\046\152\271\064\006\340\361\101\227\157"
	"\126\121\224\260\144\270\032\047\024\253\143\045\052\342\052\075"
	"\175\137\016\236\241\241\032\371\220\011\106\057\007\076\023\163"
	"\262\232\227\074\316\245\054\304\152\375\055\052\036\323\266\173"
	"\332\246\027\065\105\022\163\115\120\373\164\053\366\311\315\200"
	"\342\350\345\114\203\375\303\065\376\175\135\027\365\334\272\144"
	"\200\124\230\100\125\211\224\331\222\373\110\212\177\145\156\342"
	"\012\365\140\016\226\066\173\006\276\254\136\147\327\314\316\100"
	"\233\316\317\314\244\123\326\200\130\177\243\227\262\000\353\134"
	"\235\260\052\100\105\347\305\301\230\006\002\200\203\127\316\266"
	"\313\112\305\344\035\303\345\120\013\301\073\277\146\122\365\072"
	"\321\235\265\211\356\023\230\054\143\002\335\170\324\311\126\202"
	"\223\127\276\014\155\374\200\014\253\271\356\010\031\032\301\014"
	"\374\167\114\005\156\214\325\045\154\007\024\236\371\250\302\351"
	"\227\101\353\066\177\361\052\070\173\062\254\027\372\165\066\366"
	"\240\005\046\370\313\250\343\223\111\156\153\065\063\243\041\072"
	"\311\161\311\272\024\024\270\175\370\314\107\126\054\161\101\071"
	"\161\316\147\220\103\337\013\011\130\260\214\037\002\320\016\010"
	"\215\352\347\006\115\226\054\017\211\101\037\211\270\162\264\366"
	"\066\361\025\047\247\125\075\353\314\072\164\211\315\317\351\145"
	"\252\212\014\173\261\203\327\017\005\355\336\314\043\016\277\363"
	"\003\075\355\034\152\014\065\125\365\100\172\026\031\352\062\104"
	"\324\270\120\314\126\242\303\316\304\005\243\214\072\276\350\301"
	"\101\066\173\264\340\314\315\267\215\324\266\212\350\055\235\303"
	"\276\327\115\153\215\360\310\154\037\213\065\114\214\050\303\152"
	"\234\367\047\366\103\333\250\126\226\360\250\371\177\025\130\101"
	"\366\216\066\253\255\345\132\210\044\040\242\354\356\073\062\135"
	"\204\062\001\146\070\270\070\036\156\145\200\327\022\153\026\254"
	"\040\214\234\274\104\363\325\241\123\206\364\031\071\052\221\310"
	"\350\240\043\027\271\324\032\330\112\376\377\015\251\341\146\053"
	"\155\352\242\207\045\310\016\263\337\335\124\221\345\175\147\344"
	"\211\136\166\067\362\055\232\360\152\021\371\064\253\374\077\046"
	"\360\116\130\120\124\311\325\112\054\063\165\271\357\034\232\273"
	"\203\320\124\127\345\006\053\340\326\344\256\205\057\177\150\275"
	"\170\076\022\070\155\327\147\262\170\220\323\067\170\247\254\155"
	"\073\211\060\041\133\334\220\225\252\004\123\030\113\255\022\241"
	"\354\313\147\136\157\150\346\150\331\054\237\201\171\302\050\042"
	"\006\367\346\200\265\001\134\261\056\374\257\122\370\043\021\270"
	"\002\265\067\255\203\373\151\324\226\052\374\322\323\312\227\051"
	"\251\043\132\272\370\224\056\112\366\173\116\042\142\135\113\202"
	"\117\360\266\021\047\040\035\004\373\013\043\147\205\361\327\007"
	"\034\311\150\164\060\131\042\022\256\303\016\203\013\232\120\134"
	"\156\213\035\112\070\101\040\166\111\044\061\175\162\130\026\161"
	"\113\372\021\301\255\065\352\144\301\001\376\150\014\334\010\132"
	"\022\357\161\212\205\071\335\226\156\362\004\073\030\155\266\006"
	"\153\360\353\065\126\002\157\357\243\245\200\042\347\004\354\027"
	"\144\011\247\155\035\040\004\047\132\066\365\024\255\245\377\343"
	"\332\300\173\020\371\070\300\275\013\141\037\310\331\014\134\322"
	"\127\315\064\265\070\301\375\111\154\173\377\214\165\051\305\157"
	"\166\243\213\212\366\310\276\356\256\161\120\006\364\176\140\231"
	"\066\011\135\065\071\233\356\056\133\352\263\354\334\042\001\160"
	"\156\126\233\331\252\210\357\110\174\235\120\277\257\232\033\102"
	"\230\264\263\255\052\113\125\074\040\066\350\317\104\074\165\143"
	"\206\054\064\312\041\226\165\152\345\351\066\157\321\110\220\364"
	"\254\272\122\350\303\101\165\161\212\347\133\364\070\254\163\057"
	"\033\150\111\127\313\121\220\127\344\050\010\211\144\161\266\067"
	"\263\263\136\067\074\352\151\160\117\327\176\173\100\360\314\200"
	"\340\227\070\047\153\231\043\321\251\005\134\366\001\156\170\000"
	"\210\376\056\161\233\131\204\117\161\365\116\100\374\273\345\160"
	"\125\300\106\256\276\055\126\026\342\107\012\317\367\011\256\247"
	"\030\210\025\367\136\075\123\006\121\271\201\356\361\373\073\377"
	"\121\071\101\305\337\203\063\277\230\015\366\314\332\043\265\207"
	"\035\120\075\264\256\272\056\363\100\231\154\367\262\041\222\351"
	"\242\216\023\156\371\177\230\254\137\355\026\044\310\121\203\005"
	"\144\211\011\144\235\106\017\234\217\071\054\024\270\027\216\235"
	"\307\201\027\241\260\253\034\131\253\051\146\363\025\130\322\216"
	"\117\171\011\154\046\003\147\174\271\365\022\051\262\240\150\377"
	"\030\137\155\377\175\310\257\155\355\234\146\075\344\343\222\371"
	"\061\012\213\025\032\230\010\245\215\167\061\267\075\276\363\176"
	"\161\377\010\036\167\132\371\066\112\143\263\027\227\357\257\072"
	"\331\031\364\156\325\262\340\133\255\172\351\205\007\136\060\242"
	"\133\165\016\324\050\010\225\011\113\036\152\047\277\323\220\141"
	"\257\254\156\353\307\206\002\131\330\137\057\350\176\063\055\061"
	"\165\106\267\114\243\221\160\120\141\373\101\264\010\335\126\030"
	"\062\125\230\142\201\075\121\132\066\010\325\214\100\331\247\145"
	"\273\107\235\147\166\056\135\257\025\275\011\300\150\301\273\113"
	"\274\072\277\176\312\336\160\273\215\036\250\122\371\116\200\257"
	"\321\143\235\325\167\124\242\235\037\115\047\153\073\300\323\254"
	"\123\176\173\325\036\001\003\165\357\312\114\232\336\214\367\303"
	"\230\003\246\236\045\000\221\047\022\243\214\220\027\236\114\231"
	"\063\156\354\243\132\017\347\124\240\242\055\323\022\104\074\105"
	"\140\324\044\242\017\127\232\347\075\342\316\145\312\121\041\305"
	"\007\204\065\066\363\216\162\274\074\206\047\310\115\216\122\031"
	"\046\212\377\375\206\175\111\324\313\162\005\132\123\177\240\242"
	"\160\053\203\042\213\274\335\011\150\375\005\075\023\075\315\205"
	"\137\153\335\136\112\015\041\307\163\266\145\143\325\143\222\331"
	"\357\030\214\037\066\065\233\275\305\165\264\071\252\163\171\165"
	"\015\210\350\107\152\306\205\230\060\040\272\225\016\203\036\232"
	"\161\057\047\174\203\041\132\246\257\153\212\353\305\315\363\063"
	"\127\052\071\066\217\250\103\156\271\374\217\165\060\330\056\053"
	"\204\046\032\176\176\312\203\354\134\247\202\020\372\031\006\214"
	"\214\154\334\344\033\117\003\340\251\122\030\054\256\341\360\255"
	"\371\147\166\116\101\322\366\060\365\024\214\365\103\222\310\043"
	"\055\172\262\344\335\063\337\203\127\344\014\023\125\366\221\200"
	"\200\213\227\037\367\241\073\142\100\351\025\232\230\354\333\073"
	"\361\154\353\164\111\012\120\154\214\021\150\205\365\055\350\051"
	"\046\032\375\374\240\102\221\141\030\304\277\006\106\043\004\026"
	"\223\364\066\145\226\242\207\025\242\142\022\070\030\033\274\301"
	"\345\304\041\105\230\212\144\313\322\313\035\202\105\253\360\214"
	"\325\365\327\111\114\211\246\007\063\256\057\052\267\164\367\115"
	"\325\122\133\142\137\311\143\357\215\252\357\060\066\334\210\204"
	"\212\347\341\065\332\114\233\333\057\236\371\235\127\301\066\013"
	"\042\330\066\110\047\343\163\347\015\103\122\230\273\071\274\273"
	"\130\175\146\366\063\174\172\274\176\113\255\000\046\265\220\334"
	"\207\357\246\035\323\141\346\332\064\272\041\103\347\300\264\030"
	"\235\110\012\057\043\157\071\345\311\216\277\327\161\022\131\071"
	"\223\202\021\250\025\232\216\020\122\045\314\251\067\143\157\102"
	"\305\303\031\335\330\030\241\370\105\021\375\150\231\343\132\021"
	"\314\136\354\270\170\353\262\346\213\227\261\121\336\370\026\200"
	"\203\147\114\276\256\067\320\034\341\035\011\242\263\171\306\370"
	"\000\131\311\136\316\122\311\376\303\204\276\036\243\037\020\256"
	"\334\246\346\260\314\374\073\033\166\071\135\200\006\360\034\126"
	"\337\327\231\207\231\272\276\225\023\101\372\040\103\035\316\117"
	"\237\234\222\254\346\117\152\320\363\141\123\124\107\076\037\073"
	"\034\261\227\351\344\225\023\336\244\324\307\025\121\107\137\041"
	"\306\043\216\273\242\212\151\350\151\000\242\124\043\141\336\100"
	"\374\376\310\255\155\235\031\060\252\162\361\050\112\034\254\261"
	"\021\214\012\242\043\276\227\377\121\275\364\152\157\162\203\312"
	"\076\022\045\002\362\001\204\171\304\210\334\144\333\325\375\152"
	"\140\211\336\335\033\100\172\263\050\062\175\304\175\115\232\035"
	"\377\131\357\206\034\176\054\362\312\306\114\075\025\326\316\252"
	"\163\210\016\122\134\366\263\237\143\001\147\065\067\236\212\147"
	"\273\130\024\073\015\273\374\116\217\137\307\136\373\311\376\240"
	"\213\317\222\106\175\000\360\230\244\206\034\350\276\244\115\155"
	"\205\202\001\303\242\330\213\335\035\214\130\234\305\056\351\056"
	"\172\111\334\013\016\214\325\122\005\277\017\045\273\322\357\001"
	"\007\145\212\012\134\140\305\075\117\364\050\036\112\040\160\230"
	"\022\262\364\217\056\146\325\327\003\030\307\013\030\224\255\122"
	"\172\123\207\247\165\354\004\274\026\221\104\222\376\113\120\306"
	"\044\046\302\170\321\100\024\170\260\277\250\105\373\213\230\342"
	"\173\160\134\102\223\271\335\102\126\267\122\077\335\327\237\357"
	"\327\114\320\154\163\304\135\106\136\062\177\024\273\163\256\356"
	"\366\121\035\330\052\044\261\241\133\210\307\112\244\042\267\317"
	"\007\322\222\216\110\045\374\173\150\005\073\375\245\100\374\251"
	"\365\106\210\307\115\004\072\034\353\173\130\303\277\241\200\217"
	"\365\172\356\005\334\251\205\032\252\144\001\155\206\371\066\117"
	"\124\103\121\242\232\225\241\313\355\332\141\272\017\142\302\334"
	"\052\233\214\012\262\044\172\277\331\045\275\076\165\206\132\230"
	"\124\204\366\220\042\001\117\210\054\365\321\347\333\375\035\101"
	"\211\306\113\142\054\014\274\133\322\025\144\024\117\244\345\163"
	"\127\071\332\124\145\162\065\131\264\012\365\134\026\340\317\144"
	"\172\105\075\137\133\135\322\172\153\112\161\122\174\333\343\062"
	"\201\357\123\050\047\313\136\157\307\370\140\043\100\330\031\372"
	"\216\355\264\211\357\127\345\166\274\050\056\176\206\124\337\267"
	"\153\342\273\055\373\301\245\370\075\160\052\037\336\235\141\274"
	"\301\347\373\350\150\042\211\074\375\274\201\145\037\366\352\270"
	"\030\367\012\302\370\011\334\335\152\247\357\240\122\361\030\320"
	"\067\077\251\006\310\265\323\212\317\346\020\062\327\076\026\067"
	"\112\273\253\123\230\222\033\337\250\373\177\126\054\344\234\001"
	"\057\227\054\212\017\263\252\277\136\233\105\157\304\026\044\357"
	"\113\222\362\321\031\243\024\161\143\343\374\346\113\266\151\025"
	"\366\261\221\365\163\046\314\012\252\007\156\026\262\234\073\122"
	"\342\116\042\117\250\331\150\017\246\072\171\335\125\253\152\054"
	"\326\106\001\324\324\334\150\275\350\304\331\224\213\054\256\202"
	"\263\040\256\365\041\362\201\215\067\121\053\016\271\033\266\133"
	"\065"
#define      opts_z	1
#define      opts	((&data[3252]))
	"\060"
#define      msg2_z	19
#define      msg2	((&data[3254]))
	"\135\110\326\376\315\273\140\237\167\213\171\115\120\046\360\115"
	"\116\105\246\356\362"
#define      tst2_z	19
#define      tst2	((&data[3274]))
	"\174\121\247\210\073\105\262\353\112\027\303\207\142\320\362\237"
	"\236\034\334\235\244\016"
#define      lsto_z	1
#define      lsto	((&data[3296]))
	"\321"
#define      date_z	1
#define      date	((&data[3297]))
	"\264"
#define      xecc_z	15
#define      xecc	((&data[3300]))
	"\336\277\136\373\315\306\374\141\175\370\306\266\136\012\072\326"
	"\333\230"
#define      pswd_z	256
#define      pswd	((&data[3365]))
	"\270\127\363\213\111\330\234\224\044\314\362\113\327\242\322\232"
	"\071\055\170\341\051\366\127\115\371\020\300\233\167\054\375\122"
	"\023\233\225\145\155\100\276\245\305\355\217\270\153\041\166\213"
	"\357\040\006\223\014\304\234\014\164\072\275\007\302\303\261\016"
	"\360\226\174\041\331\014\216\022\004\162\211\314\335\053\217\115"
	"\102\263\000\314\121\316\346\177\363\050\317\046\360\142\164\054"
	"\012\225\323\315\145\357\245\045\261\120\234\266\335\161\023\174"
	"\164\053\336\373\263\276\013\257\375\153\171\144\244\051\124\004"
	"\277\167\070\050\052\236\064\221\157\011\112\206\157\056\001\041"
	"\273\377\270\310\276\035\270\315\277\274\125\173\346\030\065\013"
	"\367\263\230\000\235\045\352\216\110\242\037\301\262\370\376\140"
	"\312\236\242\004\117\055\330\254\130\206\140\357\024\011\121\277"
	"\262\370\215\066\055\155\003\230\025\236\306\132\054\212\322\154"
	"\245\335\271\052\134\152\063\246\225\115\321\311\327\100\130\042"
	"\375\236\137\060\271\371\055\113\264\364\206\301\270\057\263\007"
	"\166\223\342\362\113\313\157\333\370\106\065\276\357\134\021\305"
	"\201\056\062\141\136\272\210\251\323\144\102\124\342\210\170\301"
	"\254\371\041\044\050\237\352\255\313\330\235\325\116\330\316\151"
	"\000\163\043\033\140\037\062\227\171\205\216\044\322\266\013\237"
	"\115\255\102\355\372\135\120\200\101\235\061\020\262\211\115\333"
	"\314\077\345\371\202\030\333\176\357\156\344\006\371\236\064\325"
	"\053\077\127\172\070\224\354\220\041\262\172\036\323\113\150\152"
	"\215\055\201\166\306\016\025\261\136\046\352\071"
#define      shll_z	10
#define      shll	((&data[3682]))
	"\354\027\334\226\365\021\123\146\252\262\217\007\141\045"
#define      chk2_z	19
#define      chk2	((&data[3695]))
	"\114\300\153\012\352\224\360\041\152\073\252\257\057\105\124\114"
	"\262\161\330\344"
#define      tst1_z	22
#define      tst1	((&data[3716]))
	"\220\075\316\327\005\041\165\145\017\355\074\343\006\007\170\210"
	"\247\100\306\202\054\164\242\221"
#define      msg1_z	42
#define      msg1	((&data[3739]))
	"\270\276\121\367\006\132\222\213\135\175\156\332\365\165\066\016"
	"\140\262\355\203\340\316\257\355\067\342\104\270\222\226\210\041"
	"\077\064\020\023\277\322\046\127\301\317\337\335\017\366\030\071"
#define      chk1_z	22
#define      chk1	((&data[3787]))
	"\315\311\126\027\371\345\164\256\230\055\216\155\142\120\325\344"
	"\144\145\316\023\371\042\312\147"
#define      rlax_z	1
#define      rlax	((&data[3810]))
	"\042"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
